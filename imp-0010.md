```
IMP: 10
Title: User Defined Object Access Control
Author: Gordon Hall <gordonh@member.fsf.org>
Status: Draft
Type: Standard
Created: 2017-08-01
```

Abstract
--------

An extension to the ORC contract and shard descriptor specification that 
instructs data custodians to ignore the standard strict access control in favor 
of user defined access control would allow for objects stored in the ORC 
network to be made publicly or selectively accessible to other idendities. In 
addition, the specification of a shareable URI format would enable public 
object pointers to be stored within the ORC DHT and provide the groundwork for 
user-friendly lookup and retrieval of public objects.

Motivation
----------

TODO

Specification
-------------



### Contract Extensions



### Publishing Object Pointers



### Magnet URI Scheme

!! - TODO: Encrypt the object pointer and include key in magnet

Once the object pointer has been stored in the DHT, it can be represented for 
lookup using a the standard [Magnet URI]() scheme. ORC magnets require 2 
parameters to be valid: 

* `xt` (exact topic) - `urn:orc:{hash}`
* `x.ecprv` (private key) - `{key}`

> Optionally, the size and name of the object referenced by the pointer may be 
> added as the `xl` (exact length) and `dn` (display name) parameters, 
> respectively. 

The value of the `{hash}` placeholder in the URN example above must be the hex 
encoded RIPEMD-160 hash of the SHA-256 hash of the object pointer to which it 
is in reference. The value of the `x.pk` parameter must be the hex encoded 32 
byte EC private key required to decrypt the object to which the pointer is in 
reference.

Given an object pointer:

```
{
  "name": "README.md",
  "size": 3229
  "encoding": "7bit",
  "mimetype": "text/plain",
  "ecpub": "03fde34849918edde3870bdff2c8f80a741e8955458d6430723e98ff6aad0b68d8",
  "hash": "877167565af0376f2fddb170ad0483f91e9b932d72052720ae15efeb8ec2b010",
  "shards": [
    {
      "index": 0,
      "size": 1616,
      "hash": "18b42cc5da5b3d4bb4f32bc7e5d9d66c28ed1df8",
      "service": [
        "58cde082962e4d7c10c29c344efb0be7724514be",
        {
          "protocol": "https:"
          "hostname": "xf6zfozlg44mwizu.onion",
          "port": 443,
        }
      ]
    },
    {
      "index": 1,
      "size": 1616,
      "hash": "a519fc67c54717a75b8f0898bfb4ffb90c109f20",
      "service": [
        "8e125394ab60a24a44f6c622881497e961920393",
        {
          "protocol": "https:",
          "hostname": "dphzfwpok5pg3zrt.onion",
          "port": 443
        }
      ]
    },
    {
      "index": 2,
      "size": 1616,
      "hash": "dde3c7a7bf1a3685ce2b15bb1f62b8f020746162",
      "service": [
        "45818c9ee3f5af0961b6eee78daf0f530d61b12d",
        {
          "protocol": "https:",
          "hostname": "yn6rq6akhlgdbbel.onion",
          "port": 443
        }
      ]
    }
  ]
}
```

And the referenced object is encrypted using ECDH from `ecpub` to an arbitrary 
private key `d9a5d645a543564d0127e8462bb01fd1b5586a34f67c8fa2dbafc89b091c2e1e` 
the resulting ORC magnet URI would be (`xs` and `dn` included below but are 
optional):

```
magnet:?xt=urn:orc:2af7f11641602d7e84d22c11f6c33b197f255af0
&xs=3229
&dn=README.md
&x.ecprv=d9a5d645a543564d0127e8462bb01fd1b5586a34f67c8fa2dbafc89b091c2e1e
```

Given this information, an ORC node can perform a content-addressable lookup in 
the DHT for `2af7f11641602d7e84d22c11f6c33b197f255af0` to discover the object 
pointer. Once the pointer is obtained, provided that the requester has the 
appropriate authorization, the shards can be retrieved from the network and the 
object can be decrypted using ECDH given the `ecprv` in the URI and the `ecpub` 
defined in the pointer itself.

Backwards Compatibility
----------------------

TODO

Reference Implementation
-----------------------

TODO

References
-------------

TODO
